const questions = [
    {
        "question": "The elements between the <td> and </td> tags of an HTML table are ______ by default.",
        "type": "radio",
        "options": [
            {
                "label": "Justified",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Left aligned",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "Centrally aligned",
                "value": 3, "is_correct": false
            },
            {
                "label": "Right aligned",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": ".NET Framework was designed and developed by _______.",
        "type": "radio",
        "options": [
            {
                "label": "Microsoft",
                "value": 1,
                "is_correct": true
            },
            {
                "label": "IBM",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Oracle",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Google",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "The basic elements of a form are called :",
        "type": "radio",
        "options": [
            {
                "label": "Objects",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Table",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Record",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Controls",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "The stylesheet file will not be loaded by the browser if you omit ______",
        "type": "radio",
        "options": [
            {
                "label": "REL",
                "value": 1,
                "is_correct": true
            },
            {
                "label": "STYLE",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "BODY",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "HTML",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following multimedia text-based features generalize the concepts of footnotes and cross-references for accessing text documents?",
        "type": "radio",
        "options": [
            {
                "label": "Text importing and exporting",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Text style",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Hypertext",
                "value": 3,
                "is_correct": true
            },
            {
                "label": "Text search",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "What is the latest version of CSS available?",
        "type": "radio",
        "options": [
            {
                "label": "CSS2",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "CSS3",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "CSS3.1",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "CSS4",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "What does the abbreviation HTML stand for?",
        "type": "radio",
        "options": [
            {
                "label": "HyperText Markup Language",
                "value": 1,
                "is_correct": true
            },
            {
                "label": "HighText Markup Language",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "HyperText Markdown Language",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "None of the above",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "The correct sequence of HTML tags for starting a webpage is -",
        "type": "radio",
        "options": [
            {
                "label": "Head, Title, HTML, Body",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "HTML, Body, Title, Head",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "HTML, Head, Title, Body",
                "value": 3, "is_correct": true
            },
            {
                "label": "HTML, Title, Head, Body",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following element is responsible for making the text bold in HTML?",
        "type": "radio",
        "options": [
            {
                "label": "<pre>",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "<a>",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "<b>",
                "value": 3,
                "is_correct": true
            },
            {
                "label": "<br>",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following tag is used for inserting the largest heading in HTML?",
        "type": "radio",
        "options": [
            {
                "label": "<h3>",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "<h1>",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "<h5>",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "<h6>",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "How to create an unordered list (a list with the list items in bullets) in HTML?",
        "type": "radio",
        "options": [
            {
                "label": "<ul>",
                "value": 1,
                "is_correct": true
            },
            {
                "label": "<ol>",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "<li>",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "<i>",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following tag is used to define options in a drop-down selection list?",
        "type": "radio",
        "options": [
            {
                "label": "<select>",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "<list>",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "<dropdown>",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "<option>",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "HTML tags are enclosed in-",
        "type": "radio",
        "options": [
            {
                "label": "# and #",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "{ and }",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "! and ?",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "< and >",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "Which of the following tag is used to add rows in the table?",
        "type": "radio",
        "options": [
            {
                "label": "<td> and </td>",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "<th> and </th>",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "<tr> and </tr>",
                "value": 3,
                "is_correct": true
            },
            {
                "label": "<row> and </row>",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "The <hr> tag in HTML is used for -",
        "type": "radio",
        "options": [
            {
                "label": "New line",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Vertical ruler",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "New paragraph",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Horizontal ruler",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "Which of the following attribute is used to provide a unique name to an element?",
        "type": "radio",
        "options": [
            {
                "label": "class",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "id",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "type",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "None of the above",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "What are the types of unordered or bulleted list in HTML?",
        "type": "radio",
        "options": [
            {
                "label": "Disc, square, triangle",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Polygon, triangle, circle",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Disc, circle, square",
                "value": 3,
                "is_correct": true
            },
            {
                "label": "All of the above",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "CSS stands for -",
        "type": "radio",
        "options": [
            {
                "label": "Cascade style sheets",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Color and style sheets",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Cascading style sheets",
                "value": 3,
                "is_correct": true
            },
            {
                "label": "None of the above",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following is the correct syntax for referring the external style sheet?",
        "type": "radio",
        "options": [
            {
                "label": "<style src = example.css>",
                "value": 1,
                "is_correct": false
            },
            {
                "label": '<style src = "example.css" >',
                "value": 2,
                "is_correct": false
            },
            {
                "label": "<stylesheet> example.css </stylesheet>",
                "value": 3,
                "is_correct": false
            },
            {
                "label": '<link rel="stylesheet" type="text/css" href="example.css">',
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "The property in CSS used to change the text color of an element is -",
        "type": "radio",
        "options": [
            {
                "label": "bgcolor",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "color",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "background-color",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "All of the above",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which type of JavaScript language is ___",
        "type": "radio",
        "options": [
            {
                "label": "Object-Oriented",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Object-Based",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "Assembly-language",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "High-level",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which one of the following also known as Conditional Expression:",
        "type": "radio",
        "options": [
            {
                "label": "Alternative to if-else",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Switch statement",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "If-then-else statement",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Immediate if",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "In JavaScript, what is a block of statement?",
        "type": "radio",
        "options": [
            {
                "label": "Conditional block",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Block that combines a number of statements into a single compound statement",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "Both conditional block and a single statement",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Block that contains a single statement",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": 'The "function" and " var" are known as:',
        "type": "radio",
        "options": [
            {
                "label": "Keywords",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Data types",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Declaration statements",
                "value": 3,
                "is_correct": true
            },
            {
                "label": "Prototypes",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following variables takes precedence over the others if the names are the same?",
        "type": "radio",
        "options": [
            {
                "label": "Global variable",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "The local element",
                "value": 2,
                "is_correct": true
            },
            {
                "label": "The two of the above",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "None of the above",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which one of the following is the correct way for calling the JavaScript code?",
        "type": "radio",
        "options": [
            {
                "label": "Preprocessor",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Triggering Event",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "RMI",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Function/Method",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "Which of the following type of a variable is volatile?",
        "type": "radio",
        "options": [
            {
                "label": "Mutable variable",
                "value": 1,
                "is_correct": true
            },
            {
                "label": "Dynamic variable",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "Volatile variable",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Immutable variable",
                "value": 4,
                "is_correct": false
            }
        ]
    },
    {
        "question": "Which of the following option is used as hexadecimal literal beginning?",
        "type": "radio",
        "options": [
            {
                "label": "00",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "0x",
                "value": 2,
                "is_correct": false
            },
            {
                "label": "0X",
                "value": 3,
                "is_correct": false
            },
            {
                "label": "Both 0x and 0X",
                "value": 4,
                "is_correct": true
            }
        ]
    },
    {
        "question": "When there is an indefinite or an infinite value during an arithmetic computation in a program, then JavaScript prints______.",
        "type": "radio",
        "options": [
            {
                "label": "Prints an exception error",
                "value": 1,
                "is_correct": false
            },
            {
                "label": "Prints an overflow error",
                "value": 2,
                "is_correct": false
            },
            {
                "label": 'Displays "Infinity"',
                "value": 3,
                "is_correct": true
            },
            {
                "label": 'Prints the value as such',
                "value": 4,
                "is_correct": false
            }
        ]
    }
]

//next question waiting seconds
const timer = 5;

//Generate random array ranges from 0 to question.length-1;
const randomIndices = [];

while (randomIndices.length < 10) {
    const randomIndex = Math.floor(Math.random() * questions.length);
    if (!randomIndices.includes(randomIndex)) {
        randomIndices.push(randomIndex);
    }
}

const divEl = document.createElement('div');
divEl.id = "form-div";
const scoreDivEl = document.createElement('div');
divEl.appendChild(scoreDivEl);

const quizFormEl = document.createElement('form');
quizFormEl.id = 'quizForm';
quizFormEl.method = 'post';
quizFormEl.action = 'javascript:void(0)';

const quizHeadingEl = document.createElement('h1');
quizHeadingEl.textContent = 'Quiz: Test Your Knowledge';
quizFormEl.appendChild(quizHeadingEl);

displayStartButton();
let currentQuestionIndex = 0;
let score = 0;

function displayQuestion() {
    const question = questions[randomIndices[currentQuestionIndex]];

    const questionDivEl = document.createElement("div");
    questionDivEl.className = "question-container";

    const questionLabelEl = document.createElement("label");
    questionLabelEl.textContent = `Q${currentQuestionIndex + 1}. ${question.question}`;
    questionDivEl.appendChild(questionLabelEl);

    const optionDivEl = document.createElement("div");
    const optionClassName = 'quiz-option';
    question.options.forEach(option => {

        const inputEl = document.createElement("input");
        const randomName = randomString(10);
        inputEl.type = question.type;
        inputEl.value = option.value;
        inputEl.addEventListener('click', buttonWithTimer('.quiz-next'));
        inputEl.id = randomName;
        inputEl.className = optionClassName;
        inputEl.name = `Q${randomIndices[currentQuestionIndex] + 1}`;

        const optionLabel = document.createElement("label");
        optionLabel.textContent = option.label;
        optionLabel.setAttribute("for", randomName);

        optionDivEl.appendChild(inputEl);
        optionDivEl.appendChild(optionLabel);
        optionDivEl.appendChild(document.createElement('br'));
    });

    questionDivEl.appendChild(optionDivEl);
    quizFormEl.appendChild(questionDivEl);
    quizFormEl.appendChild(document.createElement('br'));

    if (currentQuestionIndex === randomIndices.length - 1) {
        displaySubmitButton();
    }
    else {
        displayNextButton();
    }
    
    window.scroll(0, document.body.scrollHeight);
}
let timerValue = timer;
let timerInterval;
function buttonWithTimer(id) {
    timerValue = timer;
    return function () {
        const buttonWithTimer = document.querySelector(id);
        if (buttonWithTimer) {
            buttonWithTimer.textContent = `Next (${timerValue}s)`;
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            timerInterval = setInterval(() => {
                timerValue--;

                if (timerValue <= 0) {
                    buttonWithTimer.textContent = 'Next';
                    buttonWithTimer.click();
                } else {
                    buttonWithTimer.textContent = `Next (${timerValue}s)`;
                }
            }, 1000);
        }
    }
}
function displayNextButton() {
    const nextBtn = document.createElement('button');
    nextBtn.type = 'button';
    nextBtn.className = 'quiz-next';
    nextBtn.textContent = 'Next';
    nextBtn.disabled = 'true';

    const options = document.querySelectorAll(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]`);
    options.forEach(option => {
        option.addEventListener('change', () => {
            const selectedOptions = document.querySelectorAll(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]:checked`);
            nextBtn.disabled = selectedOptions.length === 0;
        });
    });

    nextBtn.addEventListener('click', () => {
        clearInterval(timerInterval);
        nextBtn.remove();
        const radioOptions = document.querySelectorAll(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]`);
        radioOptions.forEach(option => {
            option.disabled = true;
        });
        const selectedOption = document.querySelector(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]:checked`);
        calculateScore(selectedOption, currentQuestionIndex);

        currentQuestionIndex++;

        if (currentQuestionIndex !== randomIndices.length) {
            displayQuestion();
        }

    });

    quizFormEl.appendChild(nextBtn);
}

let intervalStarted = false;
function displaySubmitButton() {
    const submitBtn = document.createElement('button');
    submitBtn.type = 'submit';
    submitBtn.className = 'quiz-submit';
    submitBtn.textContent = 'Submit Quiz';
    submitBtn.disabled = 'true';

    const options = document.querySelectorAll(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]`);
    options.forEach(option => {
        option.addEventListener('change', () => {
            const selectedOptions = document.querySelectorAll(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]:checked`);
            submitBtn.disabled = selectedOptions.length === 0;
            setTimeout(() => {

                if (selectedOptions.length > 0 && !intervalStarted) {
                    intervalStarted = true;
                    timerValue = timer;
                    submitBtn.textContent = `Submit Quiz (${timerValue})`;
                    intervalId = setInterval(() => {
                        timerValue--;

                        if (timerValue <= 0) {
                            clearInterval(intervalId);
                            submitBtn.textContent = `Submit Quiz`;
                            quizFormEl.dispatchEvent(new Event('submit'));
                        }
                        else {
                            submitBtn.textContent = `Submit Quiz (${timerValue})`;
                        }

                    }, 1000);
                }

            });
        }, 0);
    });

    quizFormEl.appendChild(submitBtn);
}

quizFormEl.addEventListener('submit', calculateQuizScore);


function calculateQuizScore(e) {
    e.preventDefault();
    const selectedOption = document.querySelector(`input[name="Q${randomIndices[currentQuestionIndex] + 1}"]:checked`);

    calculateScore(selectedOption, currentQuestionIndex);

    window.scroll(0, 0);
    scoreDivEl.className = "quiz-score";
    scoreDivEl.textContent = (`Your score: ${score}/${randomIndices.length}`);

    const outcomeDiv = document.createElement('div');
    outcomeDiv.className = 'quiz-outcome';

    const outcomeText = document.createElement('p');
    outcomeText.textContent = `You ${score >= (randomIndices.length / 2) ? 'passed' : 'failed'} the quiz.`;

    outcomeDiv.appendChild(outcomeText);
    divEl.appendChild(outcomeDiv);

    const button = document.querySelector('button');
    if (button) {
        quizFormEl.removeChild(button);
    }
    displayRestartButton();
}

function calculateScore(selectedOption, currentQuestionIndex) {
    if (selectedOption) {
        const selectedValue = parseInt(selectedOption.value);
        const currentQuestion = questions[randomIndices[currentQuestionIndex]];

        const selectedAnswerLabel = document.querySelector('label[for=' + selectedOption.id + ']');
        if (currentQuestion.options.find(option => option.value === selectedValue && option.is_correct)) {
            selectedAnswerLabel.classList = 'correct-answer';
            score++;
        } else {
            selectedAnswerLabel.classList = 'incorrect-answer';
        }
    }
}

function displayStartButton() {
    const startBtn = document.createElement("button");
    startBtn.type = "button";
    startBtn.className = "quiz-start";
    startBtn.textContent = "Start Quiz";
    startBtn.addEventListener("click", () => {
        quizFormEl.removeChild(startBtn);
        displayQuestion();
    });

    quizFormEl.appendChild(startBtn);
}

function displayRestartButton() {
    const restartButtonEl = document.createElement("button");
    restartButtonEl.type = "reset";
    restartButtonEl.className = 'quiz-restart';
    restartButtonEl.textContent = "Restart Quiz";
    restartButtonEl.addEventListener("click", restartQuiz);
    quizFormEl.appendChild(restartButtonEl);
}

function restartQuiz(e) {
    window.location.reload();
}
divEl.appendChild(quizFormEl);
document.body.appendChild(divEl);

function randomString(lenString) {
    lenString = lenString === undefined ? 7 : lenString;
    const characters = "ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";

    let resultRandomString = '';

    for (let i = 0; i < lenString; i++) {
        let randomNumber = Math.floor(Math.random() * characters.length);
        resultRandomString += characters.substring(randomNumber, randomNumber + 1);
    }

    return resultRandomString;
}

